{"version":3,"sources":["subtotal_renderers.coffee"],"names":[],"mappings":"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","file":"subtotal_renderers.js","sourceRoot":"/source/","sourcesContent":["callWithJQuery = (pivotModule) ->\r\n    if typeof exports is \"object\" and typeof module is \"object\" # CommonJS\r\n        pivotModule require(\"jquery\")\r\n    else if typeof define is \"function\" and define.amd # AMD\r\n        define [\"jquery\"], pivotModule\r\n    # Plain browser env\r\n    else\r\n        pivotModule jQuery\r\n        \r\ncallWithJQuery ($) ->\r\n\r\n    SubtotalRenderer = (pivotData, opts) ->\r\n        defaults =\r\n            localeStrings:\r\n                totals: \"Totals\"\r\n\r\n        opts = $.extend defaults, opts\r\n\r\n        plus = \"\\u25B6\"\r\n        minus = \"\\u25E2\"\r\n        colAttrs = pivotData.colAttrs\r\n        rowAttrs = pivotData.rowAttrs\r\n        rowKeys = pivotData.getRowKeys()\r\n        colKeys = pivotData.getColKeys()\r\n        tree = pivotData.tree\r\n        rowTotals = pivotData.rowTotals\r\n        colTotals = pivotData.colTotals\r\n        allTotal =pivotData.allTotal\r\n        \r\n        createCell = (cellType, className, textContent, attributes) ->\r\n            th = document.createElement(cellType)\r\n            if className then th.className = className\r\n            if textContent isnt null and textContent isnt undefined then th.textContent = textContent\r\n            if attributes then th.setAttribute(attr, val) for own attr, val of attributes\r\n            return th\r\n\r\n        processKeys = (keysArr, className) ->\r\n            lastRow = keysArr.length - 1\r\n            lastCol = keysArr[0].length - 1\r\n            rMark = []\r\n            headers = []\r\n            th = createCell(\"th\", className, keysArr[0][0])\r\n            flatKey = keysArr[0][0]\r\n            nodePos = 0\r\n            node = {\"node\": nodePos, \"row\": 0, \"col\": 0, \"th\": th, \"parent\": null, \"children\": [], \"descendants\": lastCol, \"leaves\": 1, \"flatKey\": flatKey}\r\n            headers[0] = node \r\n            rMark[0] = node\r\n            c = 1\r\n            while c <= lastCol\r\n                th = createCell(\"th\", className, keysArr[0][c])\r\n                flatKey = flatKey + String.fromCharCode(0) + keysArr[0][c]\r\n                ++nodePos\r\n                node =  {\"node\": nodePos, \"row\": 0, \"col\": c, \"th\": th, \"parent\": rMark[c-1], \"children\": [], \"descendants\": lastCol-c, \"leaves\": 1, \"flatKey\": flatKey}\r\n                rMark[c] = node\r\n                rMark[c-1].children.push(node)\r\n                ++c\r\n            rMark[lastCol].leaves = 0\r\n            r = 1\r\n            while r <= lastRow\r\n                repeats = true\r\n                flatKey = \"\"\r\n                c = 0\r\n                while c <= lastCol\r\n                    flatKey = if c is 0 then keysArr[r][c] else flatKey + String.fromCharCode(0) + keysArr[r][c]\r\n                    if ((keysArr[r][c] is keysArr[rMark[c].row][c]) and (c isnt lastCol)  and (repeats))\r\n                        repeats = true\r\n                        ++c\r\n                        continue\r\n                    th = createCell(\"th\", className, keysArr[r][c])\r\n                    ++nodePos\r\n                    header = {\"node\": nodePos, \"row\": r, \"col\": c, \"th\": th, \"parent\": null, \"children\": [], \"descendants\": 0, \"leaves\": 1, \"flatKey\": flatKey}\r\n                    if c is 0\r\n                        headers.push header\r\n                    else\r\n                        header.parent = rMark[c-1]\r\n                        rMark[c-1].children.push header\r\n                        x = 0\r\n                        while x <= c-1\r\n                            rMark[x].descendants = rMark[x].descendants + 1\r\n                            ++x\r\n                    rMark[c] = header\r\n                    repeats = false\r\n                    ++c\r\n                c = 0\r\n                while c <= lastCol\r\n                    rMark[c].leaves = rMark[c].leaves + 1\r\n                    ++c\r\n                rMark[lastCol].leaves = 0\r\n                ++r\r\n            return headers\r\n\r\n        buildColHeaderHeaders = (result, colHeaderRowsArr, rowAttrs) ->\r\n            tr = document.createElement(\"tr\")\r\n            if rowAttrs.length != 0\r\n                tr.appendChild createCell(\"th\", null, null, {\"colspan\": rowAttrs.length, \"rowspan\": colAttrs.length});\r\n            tr.appendChild createCell(\"th\", \"pvtAxisLabel\", colAttrs[0])\r\n            colHeaderRowsArr[0] = tr\r\n            result.appendChild(tr)\r\n            for c in [1..colAttrs.length] when c < colAttrs.length\r\n                tr = document.createElement(\"tr\")\r\n                th = createCell(\"th\", \"pvtAxisLabel\", colAttrs[c])\r\n                tr.appendChild th\r\n                colHeaderRowsArr[c] = tr\r\n                result.appendChild(tr)\r\n                ++c\r\n\r\n        buildColHeaders = (colHeaderRowsArr, colHeaderColsArr, colHeader, parent, colAttrs, rowAttrs) ->\r\n            # DF Recurse\r\n            for h in colHeader.children\r\n                buildColHeaders(colHeaderRowsArr, colHeaderColsArr, h, colHeader, colAttrs, rowAttrs)\r\n            # Process\r\n            tr = colHeaderRowsArr[colHeader.col]\r\n            th = colHeader.th\r\n            if colHeader.col == colAttrs.length-1 and rowAttrs.length != 0\r\n                th.setAttribute(\"rowspan\", 2)\r\n            if colHeader.children.length !=0\r\n                th.setAttribute(\"colspan\", colHeader.descendants)\r\n            tr.appendChild(th)\r\n            if colHeader.children.length !=0\r\n                rowspan = colAttrs.length-colHeader.col + if rowAttrs.length != 0 then 1 else 0\r\n                th = createCell(\"th\", \"pvtColLabel\", '', {\"rowspan\": rowspan})\r\n                tr.appendChild(th)\r\n            colHeader.tr = tr\r\n            colHeaderColsArr.push(colHeader)\r\n\r\n        buildRowHeaderHeaders = (result, rowHeaderHeaders, rowAttrs, colAttrs) ->\r\n            tr = document.createElement(\"tr\")\r\n            for rowAttr in rowAttrs\r\n                th = createCell(\"th\", \"pvtAxisLabel\", rowAttr)\r\n                tr.appendChild th\r\n            if colAttrs.length != 0\r\n                th = createCell(\"th\")\r\n                tr.appendChild th\r\n            result.appendChild tr\r\n            rowHeaderHeaders.tr = tr\r\n\r\n        buildRowTotalsHeader = (tr, colAttrs, rowAttrs) ->\r\n            rowspan = 1\r\n            if colAttrs.length != 0\r\n                rowspan = colAttrs.length + (if rowAttrs.length ==0 then 0 else 1)\r\n            th = createCell(\"th\", \"pvtTotalLabel\", opts.localeStrings.totals, {\"rowspan\": rowspan})\r\n            tr.appendChild th\r\n\r\n        buildRowHeaders = (result, rowHeaderRowsArr, rowHeader, rowAttrs, colAttrs) ->\r\n            tr = document.createElement(\"tr\")\r\n            th = rowHeader.th\r\n            th.setAttribute(\"rowspan\", rowHeader.descendants+1)\r\n            if rowHeader.col == rowAttrs.length-1 and colAttrs.length != 0\r\n                th.setAttribute(\"colspan\", 2)\r\n            th.setAttribute(\"data-node\", rowHeaderRowsArr.length)\r\n            tr.appendChild(th)\r\n            if rowHeader.children.length != 0\r\n                th.onclick = (event) ->\r\n                    event = event || window.event\r\n                    toggleRow(rowHeaderRowsArr, parseInt(event.target.getAttribute(\"data-node\")))\r\n                colspan = rowAttrs.length-(rowHeader.col+1) + if colAttrs.length != 0 then 1 else 0\r\n                th = createCell(\"th\", \"pvtRowLabel\", '', {\"colspan\": colspan})\r\n                tr.appendChild(th)\r\n            rowHeader.clickStatus = \"expanded\"\r\n            rowHeader.th.textContent = \" \" + minus + \" \" + rowHeader.th.textContent\r\n            rowHeader.tr = tr\r\n            rowHeaderRowsArr.push(rowHeader)\r\n            result.appendChild(tr)\r\n            for h in rowHeader.children\r\n                buildRowHeaders(result, rowHeaderRowsArr, h, rowAttrs, colAttrs)\r\n\r\n        buildValues = (rowHeaderRowsArr, colHeaderColsArr) ->\r\n            for rowHeader in rowHeaderRowsArr\r\n                tr = rowHeader.tr\r\n                flatRowKey = rowHeader.flatKey\r\n                for colHeader in colHeaderColsArr\r\n                    flatColKey = colHeader.flatKey\r\n                    aggregator = tree[flatRowKey][flatColKey] ? {value: (-> null), format: -> \"\"}\r\n                    val = aggregator.value()\r\n                    style = \"pvtVal\"\r\n                    style = if (colHeader.children.length != 0) then  style +  \" pvtSubtotal\" else style\r\n                    style = style + \" row\"+rowHeader.row+\" col\"+colHeader.col\r\n                    td = createCell(\"td\", style, aggregator.format(val), {\"data-value\": val})\r\n                    tr.appendChild td\r\n                # buildRowTotal\r\n                totalAggregator = rowTotals[flatRowKey]\r\n                val = totalAggregator.value()\r\n                td = createCell(\"td\", \"pvtTotal rowTotal\", totalAggregator.format(val), {\"data-value\": val, \"data-row\": \"row\"+rowHeader.row, \"data-col\": \"col\"+rowHeader.col})\r\n                tr.appendChild td\r\n\r\n        buildColTotalsHeader = (rowAttrs, colAttrs) ->\r\n            tr = document.createElement(\"tr\")\r\n            colspan = rowAttrs.length + (if colAttrs.length == 0 then 0 else 1)\r\n            th = createCell(\"th\", \"pvtTotalLabel\", opts.localeStrings.totals, {\"colspan\": colspan})\r\n            tr.appendChild(th)\r\n            return tr\r\n\r\n        buildColTotals = (tr, colHeaderColsArr) ->\r\n            for h in colHeaderColsArr\r\n                totalAggregator = colTotals[h.flatKey]\r\n                val = totalAggregator.value()\r\n                td = createCell(\"td\", \"pvtTotal colTotal\", totalAggregator.format(val), {\"data-value\": val, \"data-for\": \"col\"+h.col})\r\n                tr.appendChild td\r\n\r\n        buildGrandTotal = (result, tr) ->\r\n            totalAggregator = allTotal\r\n            val = totalAggregator.value()\r\n            td = createCell(\"td\", \"pvtGrandTotal\", totalAggregator.format(val), {\"data-value\": val})\r\n            tr.appendChild td\r\n            result.appendChild tr\r\n       \r\n        collapseRow = (rowHeaderRows, r) ->\r\n            if not rowHeaderRows[r]\r\n                return\r\n            h = rowHeaderRows[r]\r\n            rowspan = 0\r\n            for i in [1..h.descendants] when h.descendants != 0\r\n                d = rowHeaderRows[r+i]\r\n                if d.descendants != 0\r\n                    str = d.th.textContent\r\n                    d.th.textContent = str.substr(0, 1) + plus + str.substr(1+minus.length);\r\n                d.clickStatus = \"collapsed\"\r\n                d.th.setAttribute(\"rowspan\", 1)\r\n                if d.tr.style.display isnt \"none\"\r\n                    ++rowspan\r\n                    d.tr.style.display = \"none\"\r\n            p = h.parent\r\n            while p isnt null\r\n                p.th.setAttribute(\"rowspan\", parseInt(p.th.getAttribute(\"rowspan\"))-rowspan)\r\n                p = p.parent\r\n            if h.descendants != 0\r\n                str = h.th.textContent\r\n                h.th.textContent = str.substr(0, 1) + plus + str.substr(1+plus.length);\r\n            h.clickStatus = \"collapsed\"\r\n            h.th.setAttribute(\"rowspan\", 1)\r\n            h.tr.style.display = \"\"\r\n            \r\n        expandRow = (rowHeaderRows, r) ->\r\n            if not rowHeaderRows[r]\r\n                return\r\n            rowspan = 0\r\n            h = rowHeaderRows[r]\r\n            for i in [1..h.descendants] when h.descendants != 0\r\n                d = rowHeaderRows[r+i]\r\n                if d.descendants != 0\r\n                    str = d.th.textContent\r\n                    d.th.textContent = str.substr(0, 1) + plus + str.substr(1+minus.length);\r\n                d.clickStatus = \"collapsed\"\r\n                d.th.setAttribute(\"rowspan\", 1)\r\n                if d.tr.style.display isnt \"none\"\r\n                    --rowspan\r\n                    d.tr.style.display = \"none\"\r\n            for c in h.children\r\n                if c.tr.style.display is \"none\"\r\n                    ++rowspan\r\n                    c.tr.style.display = \"\"\r\n            h.th.setAttribute(\"rowspan\", h.children.length+1)\r\n            if h.descendants != 0\r\n                str = h.th.textContent\r\n                h.th.textContent = str.substr(0, 1) + minus + str.substr(1+minus.length);\r\n            h.clickStatus = \"expanded\"\r\n            h.tr.style.display = \"\"\r\n            p = h.parent\r\n            while p isnt null\r\n                p.th.setAttribute(\"rowspan\", (rowspan + parseInt(p.th.getAttribute(\"rowspan\"))))\r\n                p = p.parent\r\n\r\n        toggleRow = (rowHeaderRows, r) ->\r\n            if not rowHeaderRows[r]\r\n                return\r\n            if rowHeaderRows[r].clickStatus is \"collapsed\"\r\n                expandRow(rowHeaderRows, r)\r\n            else\r\n                collapseRow(rowHeaderRows, r)\r\n\r\n        collapseRowsAt = (rowHeaderRows, col) ->\r\n            i = 0\r\n            nRows = rowHeaderRows.length\r\n            while i < nRows\r\n                h = rowHeaderRows[i]\r\n                if h.col is col\r\n                    collapseRow(rowHeaderRows, h.node)\r\n                    i = i + h.descendants + 1\r\n                else\r\n                    ++i\r\n\r\n        main = (rowAttrs, rowKeys, colAttrs, colKeys) ->\r\n            rowHeaders = []\r\n            colHeaders = []\r\n            rowHeaderHeaders = {}\r\n            rowHeaderRows = []\r\n            colHeaderRows = []\r\n            colHeaderCols = []\r\n\r\n            if rowAttrs.length != 0\r\n                rowHeaders = processKeys(rowKeys, \"pvtRowLabel\")\r\n            if colAttrs.length != 0\r\n                sTime = Date.now()\r\n                colHeaders = processKeys(colKeys, \"pvtColLabel\")\r\n            result = document.createElement(\"table\")\r\n            result.className = \"pvtTable\"\r\n            if colAttrs.length != 0\r\n                buildColHeaderHeaders(result, colHeaderRows, rowAttrs)\r\n                for h in colHeaders\r\n                    buildColHeaders(colHeaderRows, colHeaderCols, h, null, colAttrs, rowAttrs)\r\n            if rowAttrs.length != 0\r\n                buildRowHeaderHeaders(result, rowHeaderHeaders, rowAttrs, colAttrs)\r\n                if colAttrs.length == 0\r\n                    buildRowTotalsHeader(rowHeaderHeaders.tr, colAttrs, rowAttrs)\r\n            if colAttrs.length != 0\r\n                sTime = Date.now()\r\n                buildRowTotalsHeader(colHeaderRows[0], colAttrs, rowAttrs)\r\n            if rowAttrs.length != 0\r\n                for h in rowHeaders\r\n                    buildRowHeaders result, rowHeaderRows, h, rowAttrs, colAttrs\r\n            buildValues(rowHeaderRows, colHeaderCols)\r\n            tr = buildColTotalsHeader(rowAttrs, colAttrs)\r\n            if colAttrs.length != 0\r\n                buildColTotals(tr, colHeaderCols)\r\n            buildGrandTotal(result, tr)\r\n            result.setAttribute(\"data-numrows\", rowKeys.length)\r\n            result.setAttribute(\"data-numcols\", colKeys.length)\r\n            idx = rowAttrs.indexOf(opts.collapseRowsAt)\r\n            if idx != -1 and idx != rowAttrs.length-1\r\n                collapseRowsAt(rowHeaderRows, idx)\r\n            return result\r\n\r\n        return main(rowAttrs, rowKeys, colAttrs, colKeys)\r\n        \r\n    $.pivotUtilities.subtotal_renderers =\r\n        \"Table With Subtotal\":  (pvtData, opts) -> SubtotalRenderer(pvtData, opts)\r\n        \"Table With Subtotal Bar Chart\":   (pvtData, opts) -> $(SubtotalRenderer(pvtData, opts)).barchart()\r\n        \"Table With Subtotal Heatmap\":   (pvtData, opts) -> $(SubtotalRenderer(pvtData, opts)).heatmap()\r\n        \"Table With Subtotal Row Heatmap\":   (pvtData, opts) -> $(SubtotalRenderer(pvtData, opts)).heatmap(\"rowheatmap\")\r\n        \"Table With Subtotal Col Heatmap\":  (pvtData, opts) -> $(SubtotalRenderer(pvtData, opts)).heatmap(\"colheatmap\")\r\n"]}