{"version":3,"sources":["/source/c3_renderers.coffee","c3_renderers.min.js"],"names":["callWithJQuery","pivotModule","exports","module","require","define","amd","jQuery","c3","$","makeC3Chart","chartOpts","pivotData","opts","agg","attrs","base","base1","base2","base3","base4","base5","colKey","colKeys","columns","dataColumns","defaults","fullAggName","groupByTitle","h","hAxisTitle","headers","i","j","k","l","len","len1","len2","len3","len4","m","numCharsInHAxis","numSeries","params","ref","ref1","ref2","ref3","renderArea","result","rotationAngle","row","rowHeader","rowKey","rowKeys","s","scatterData","series","title","titleText","vAxisTitle","val","vals","x","xs","localeStrings","vs","by","extend","size","width","window","innerWidth","height","innerHeight","type","getRowKeys","length","push","getColKeys","results","join","aggregatorName","valAttrs","y","t","rowAttrs","concat","colAttrs","slice","getAggregator","value","format","parseFloat","isFinite","toPrecision","toFixed","style","text","axis","label","tick","rotate","multiline","data","tooltip","grouped","color","pattern","fit","legend","show","name","a","b","c","d","categories","stacked","groups","len5","n","appendTo","bindto","generate","detach","remove","append","pivotUtilities","c3_renderers","Line Chart","Bar Chart","Stacked Bar Chart","Area Chart","Scatter Chart","call","this"],"mappings":"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","file":"c3_renderers.min.js","sourcesContent":["callWithJQuery = (pivotModule) ->\n    if typeof exports is \"object\" and typeof module is \"object\" # CommonJS\n        pivotModule require(\"jquery\"), require(\"c3\")\n    else if typeof define is \"function\" and define.amd # AMD\n        define [\"jquery\", \"c3\"], pivotModule\n    # Plain browser env\n    else\n        pivotModule jQuery, c3\n\ncallWithJQuery ($, c3) ->\n\n    makeC3Chart = (chartOpts = {}) -> (pivotData, opts) ->\n        defaults =\n            localeStrings: {vs: \"vs\", by: \"by\"}\n            c3: {}\n\n        opts = $.extend(true, {}, defaults, opts)\n        opts.c3.size ?= {}\n        opts.c3.size.width ?= window.innerWidth / 1.4\n        opts.c3.size.height ?= window.innerHeight / 1.4 - 50\n        chartOpts.type ?= \"line\"\n\n        rowKeys = pivotData.getRowKeys()\n        rowKeys.push [] if rowKeys.length == 0\n        colKeys = pivotData.getColKeys()\n        colKeys.push [] if colKeys.length == 0\n\n        headers = (h.join(\"-\") for h in colKeys)\n        rotationAngle = 0\n\n        fullAggName = pivotData.aggregatorName\n        if pivotData.valAttrs.length\n            fullAggName += \"(#{pivotData.valAttrs.join(\", \")})\"\n\n        if chartOpts.type == \"scatter\"\n            scatterData = x:{}, y:{}, t:{}\n            attrs = pivotData.rowAttrs.concat(pivotData.colAttrs)\n            vAxisTitle = attrs[0] ? \"\"\n            hAxisTitle = attrs[1] ? \"\"\n            groupByTitle = attrs.slice(2).join(\"-\")\n            titleText = vAxisTitle\n            titleText += \" #{opts.localeStrings.vs} #{hAxisTitle}\" if hAxisTitle != \"\"\n            titleText += \" #{opts.localeStrings.by} #{groupByTitle}\" if groupByTitle != \"\"\n            for rowKey in rowKeys\n                for colKey in colKeys\n                    agg = pivotData.getAggregator(rowKey, colKey)\n                    if agg.value()?\n                        vals = rowKey.concat(colKey)\n                        series = vals.slice(2).join(\"-\")\n                        if series == \"\" then series = \"series\"\n                        scatterData.x[series] ?= []\n                        scatterData.y[series] ?= []\n                        scatterData.t[series] ?= []\n                        scatterData.y[series].push vals[0] ? 0\n                        scatterData.x[series].push vals[1] ? 0\n                        scatterData.t[series].push agg.format(agg.value())\n        else\n            numCharsInHAxis = 0\n            for x in headers\n                numCharsInHAxis += x.length\n            if numCharsInHAxis > 50\n                rotationAngle = 45\n\n            columns = []\n            for rowKey in rowKeys\n                rowHeader = rowKey.join(\"-\")\n                row = [if rowHeader == \"\" then pivotData.aggregatorName else rowHeader]\n                for colKey in colKeys\n                    val = parseFloat  pivotData.getAggregator(rowKey, colKey).value()\n                    if isFinite(val)\n                        if val < 1\n                            row.push val.toPrecision(3)\n                        else\n                            row.push val.toFixed(3)\n                    else\n                        row.push null\n                columns.push row\n\n            vAxisTitle = pivotData.aggregatorName+\n                if pivotData.valAttrs.length then \"(#{pivotData.valAttrs.join(\", \")})\" else \"\"\n            hAxisTitle = pivotData.colAttrs.join(\"-\")\n\n            titleText = fullAggName\n            titleText += \" #{opts.localeStrings.vs} #{hAxisTitle}\" if hAxisTitle != \"\"\n            groupByTitle = pivotData.rowAttrs.join(\"-\")\n            titleText += \" #{opts.localeStrings.by} #{groupByTitle}\" if groupByTitle != \"\"\n\n        title = $(\"<p>\", {style: \"text-align: center; font-weight: bold\"})\n        title.text(titleText)\n\n        params =\n            axis:\n                y:\n                    label: vAxisTitle\n                x:\n                    label: hAxisTitle\n                    tick:\n                        rotate: rotationAngle\n                        multiline: false\n            data:\n                type: chartOpts.type\n            tooltip:\n                grouped: false\n            color:\n                pattern: [ \"#3366cc\", \"#dc3912\", \"#ff9900\", \"#109618\",\n                           \"#990099\", \"#0099c6\", \"#dd4477\", \"#66aa00\",\n                           \"#b82e2e\", \"#316395\", \"#994499\", \"#22aa99\",\n                           \"#aaaa11\", \"#6633cc\", \"#e67300\", \"#8b0707\",\n                           \"#651067\", \"#329262\", \"#5574a6\", \"#3b3eac\" ]\n\n\n        params = $.extend(true, {}, params, opts.c3)\n\n        if chartOpts.type == \"scatter\"\n            xs = {}\n            numSeries = 0\n            dataColumns = []\n            for s of scatterData.x\n                numSeries += 1\n                xs[s] = s+\"_x\"\n                dataColumns.push [s+\"_x\"].concat(scatterData.x[s])\n                dataColumns.push [s].concat(scatterData.y[s])\n            params.data.xs = xs\n            params.data.columns = dataColumns\n            params.axis.x.tick = fit: false\n            if numSeries == 1\n                params.legend = show: false\n            params.tooltip.format =\n                title: -> fullAggName\n                name: -> \"\"\n                value: (a,b,c,d) -> scatterData.t[c][d]\n        else\n            params.axis.x.type= 'category'\n            params.axis.x.categories = headers\n            params.data.columns = columns\n\n\n        if chartOpts.stacked?\n            params.data.groups = [x.join(\"-\") for x in rowKeys]\n        renderArea = $(\"<div>\", style: \"display:none;\").appendTo $(\"body\")\n        result = $(\"<div>\").appendTo renderArea\n        params.bindto = result[0]\n        c3.generate params\n        result.detach()\n        renderArea.remove()\n        return $(\"<div>\").append title, result\n\n    $.pivotUtilities.c3_renderers =\n        \"Line Chart\": makeC3Chart()\n        \"Bar Chart\": makeC3Chart(type: \"bar\")\n        \"Stacked Bar Chart\": makeC3Chart(type: \"bar\", stacked: true)\n        \"Area Chart\": makeC3Chart(type: \"area\", stacked: true)\n        \"Scatter Chart\": makeC3Chart(type: \"scatter\")\n","(function(){var t;(t=function(t){return\"object\"==typeof exports&&\"object\"==typeof module?t(require(\"jquery\"),require(\"c3\")):\"function\"==typeof define&&define.amd?define([\"jquery\",\"c3\"],t):t(jQuery,c3)})(function(t,e){var n;return n=function(n){return null==n&&(n={}),function(r,a){var l,o,i,s,c,u,g,p,h,d,f,y,v,x,b,j,m,w,A,S,k,C,q,z,F,N,_,B,K,T,H,L,P,Q,R,U,W,D,E,G,I,J,M,O,V,X,Y,Z,$,tt,et,nt;if(v={localeStrings:{vs:\"vs\",by:\"by\"},c3:{}},a=t.extend(!0,{},v,a),null==(i=a.c3).size&&(i.size={}),null==(s=a.c3.size).width&&(s.width=window.innerWidth/1.4),null==(c=a.c3.size).height&&(c.height=window.innerHeight/1.4-50),null==n.type&&(n.type=\"line\"),J=r.getRowKeys(),0===J.length&&J.push([]),d=r.getColKeys(),0===d.length&&d.push([]),w=function(){var t,e,n;for(n=[],t=0,e=d.length;e>t;t++)j=d[t],n.push(j.join(\"-\"));return n}(),D=0,x=r.aggregatorName,r.valAttrs.length&&(x+=\"(\"+r.valAttrs.join(\", \")+\")\"),\"scatter\"===n.type)for(O={x:{},y:{},t:{}},o=r.rowAttrs.concat(r.colAttrs),Z=null!=(L=o[0])?L:\"\",m=null!=(P=o[1])?P:\"\",b=o.slice(2).join(\"-\"),Y=Z,\"\"!==m&&(Y+=\" \"+a.localeStrings.vs+\" \"+m),\"\"!==b&&(Y+=\" \"+a.localeStrings.by+\" \"+b),A=0,q=J.length;q>A;A++)for(I=J[A],S=0,z=d.length;z>S;S++)h=d[S],l=r.getAggregator(I,h),null!=l.value()&&(tt=I.concat(h),V=tt.slice(2).join(\"-\"),\"\"===V&&(V=\"series\"),null==(u=O.x)[V]&&(u[V]=[]),null==(g=O.y)[V]&&(g[V]=[]),null==(p=O.t)[V]&&(p[V]=[]),O.y[V].push(null!=(Q=tt[0])?Q:0),O.x[V].push(null!=(R=tt[1])?R:0),O.t[V].push(l.format(l.value())));else{for(K=0,k=0,F=w.length;F>k;k++)et=w[k],K+=et.length;for(K>50&&(D=45),f=[],C=0,N=J.length;N>C;C++){for(I=J[C],G=I.join(\"-\"),E=[\"\"===G?r.aggregatorName:G],B=0,_=d.length;_>B;B++)h=d[B],$=parseFloat(r.getAggregator(I,h).value()),E.push(isFinite($)?1>$?$.toPrecision(3):$.toFixed(3):null);f.push(E)}Z=r.aggregatorName+(r.valAttrs.length?\"(\"+r.valAttrs.join(\", \")+\")\":\"\"),m=r.colAttrs.join(\"-\"),Y=x,\"\"!==m&&(Y+=\" \"+a.localeStrings.vs+\" \"+m),b=r.rowAttrs.join(\"-\"),\"\"!==b&&(Y+=\" \"+a.localeStrings.by+\" \"+b)}if(X=t(\"<p>\",{style:\"text-align: center; font-weight: bold\"}),X.text(Y),H={axis:{y:{label:Z},x:{label:m,tick:{rotate:D,multiline:!1}}},data:{type:n.type},tooltip:{grouped:!1},color:{pattern:[\"#3366cc\",\"#dc3912\",\"#ff9900\",\"#109618\",\"#990099\",\"#0099c6\",\"#dd4477\",\"#66aa00\",\"#b82e2e\",\"#316395\",\"#994499\",\"#22aa99\",\"#aaaa11\",\"#6633cc\",\"#e67300\",\"#8b0707\",\"#651067\",\"#329262\",\"#5574a6\",\"#3b3eac\"]}},H=t.extend(!0,{},H,a.c3),\"scatter\"===n.type){nt={},T=0,y=[];for(M in O.x)T+=1,nt[M]=M+\"_x\",y.push([M+\"_x\"].concat(O.x[M])),y.push([M].concat(O.y[M]));H.data.xs=nt,H.data.columns=y,H.axis.x.tick={fit:!1},1===T&&(H.legend={show:!1}),H.tooltip.format={title:function(){return x},name:function(){return\"\"},value:function(t,e,n,r){return O.t[n][r]}}}else H.axis.x.type=\"category\",H.axis.x.categories=w,H.data.columns=f;return null!=n.stacked&&(H.data.groups=[function(){var t,e,n;for(n=[],e=0,t=J.length;t>e;e++)et=J[e],n.push(et.join(\"-\"));return n}()]),U=t(\"<div>\",{style:\"display:none;\"}).appendTo(t(\"body\")),W=t(\"<div>\").appendTo(U),H.bindto=W[0],e.generate(H),W.detach(),U.remove(),t(\"<div>\").append(X,W)}},t.pivotUtilities.c3_renderers={\"Line Chart\":n(),\"Bar Chart\":n({type:\"bar\"}),\"Stacked Bar Chart\":n({type:\"bar\",stacked:!0}),\"Area Chart\":n({type:\"area\",stacked:!0}),\"Scatter Chart\":n({type:\"scatter\"})}})}).call(this);\n//# sourceMappingURL=c3_renderers.min.js.map"],"sourceRoot":"/source/"}