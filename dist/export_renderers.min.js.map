{"version":3,"sources":["/source/export_renderers.coffee","export_renderers.min.js"],"names":["callWithJQuery","pivotModule","exports","module","require","define","amd","jQuery","$","pivotUtilities","export_renderers","TSV Export","pivotData","opts","agg","colAttrs","colKey","colKeys","defaults","i","j","k","l","len","len1","len2","len3","len4","len5","m","n","r","result","row","rowAttr","rowAttrs","rowKey","rowKeys","text","localeStrings","extend","getRowKeys","length","push","getColKeys","aggregatorName","join","getAggregator","value","css","width","window","height","call","this"],"mappings":"CAAA,WAAA,GAAAA,IAAAA,EAAiB,SAACC,GACd,MAAqB,gBAAXC,UAAyC,gBAAVC,QACrCF,EAAYG,QAAQ,WACC,kBAAVC,SAAyBA,OAAOC,IAC3CD,QAAQ,UAAWJ,GAGnBA,EAAYM,UAEL,SAACC,GCKZ,MDHAA,GAAEC,eAAeC,kBAAmBC,aAAc,SAACC,EAAWC,GAC1D,GAAAC,GAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,CAeA,KAfApB,GACIqB,kBAEJ1B,EAAOL,EAAEgC,OAAOtB,EAAUL,GAE1BwB,EAAUzB,EAAU6B,aACiB,IAAlBJ,EAAQK,QAA3BL,EAAQM,SACR1B,EAAUL,EAAUgC,aACiB,IAAlB3B,EAAQyB,QAA3BzB,EAAQ0B,SACRR,EAAWvB,EAAUuB,SACrBpB,EAAWH,EAAUG,SAErBiB,KAEAC,KACAd,EAAA,EAAAI,EAAAY,EAAAO,OAAAvB,EAAAI,EAAAJ,ICOEe,EAAUC,EAAShB,GDNjBc,EAAIU,KAAKT,EACb,IAAqB,IAAlBjB,EAAQyB,QAAqC,IAArBzB,EAAQ,GAAGyB,OAClCT,EAAIU,KAAK/B,EAAUiC,oBAEnB,KAAAzB,EAAA,EAAAI,EAAAP,EAAAyB,OAAAtB,EAAAI,EAAAJ,ICSAJ,EAASC,EAAQG,GDRba,EAAIU,KAAK3B,EAAO8B,KAAK,KAI7B,KAFAd,EAAOW,KAAKV,GAEZZ,EAAA,EAAAI,EAAAY,EAAAK,OAAArB,EAAAI,EAAAJ,IAAA,CAEI,ICQFe,EAASC,EAAQhB,GDTfY,KACAX,EAAA,EAAAI,EAAAU,EAAAM,OAAApB,EAAAI,EAAAJ,ICWAS,EAAIK,EAAOd,GDVPW,EAAIU,KAAKZ,EAEb,KAAAF,EAAA,EAAAF,EAAAV,EAAAyB,OAAAb,EAAAF,EAAAE,ICYAb,EAASC,EAAQY,GDXbf,EAAMF,EAAUmC,cAAcX,EAAQpB,GACnC,MAAAF,EAAAkC,QACCf,EAAIU,KAAK7B,EAAIkC,SAEbf,EAAIU,KAAK,GACjBX,GAAOW,KAAKV,GAEhB,IADAK,EAAO,GACPR,EAAA,EAAAF,EAAAI,EAAAU,OAAAZ,EAAAF,EAAAE,ICgBEC,EAAIC,EAAOF,GDfTQ,GAAQP,EAAEe,KAAK,MAAM,IAEzB,OAAOtC,GAAE,cAAc8B,KAAKA,GAAMW,KAC1BC,MAAQ1C,EAAE2C,QAAQD,QAAU,EAAK,KACjCE,OAAS5C,EAAE2C,QAAQC,SAAW,EAAK,aCsBhDC,KAAKC","file":"export_renderers.min.js","sourcesContent":["callWithJQuery = (pivotModule) ->\r\n    if typeof exports is \"object\" and typeof module is \"object\" # CommonJS\r\n        pivotModule require(\"jquery\")\r\n    else if typeof define is \"function\" and define.amd # AMD\r\n        define [\"jquery\"], pivotModule\r\n    # Plain browser env\r\n    else\r\n        pivotModule jQuery\r\n        \r\ncallWithJQuery ($) ->\r\n\r\n    $.pivotUtilities.export_renderers = \"TSV Export\": (pivotData, opts) ->\r\n        defaults =\r\n            localeStrings: {}\r\n\r\n        opts = $.extend defaults, opts\r\n\r\n        rowKeys = pivotData.getRowKeys()\r\n        rowKeys.push [] if rowKeys.length == 0\r\n        colKeys = pivotData.getColKeys()\r\n        colKeys.push [] if colKeys.length == 0\r\n        rowAttrs = pivotData.rowAttrs\r\n        colAttrs = pivotData.colAttrs\r\n\r\n        result = []\r\n\r\n        row = []\r\n        for rowAttr in rowAttrs\r\n            row.push rowAttr\r\n        if colKeys.length == 1 and colKeys[0].length == 0\r\n            row.push pivotData.aggregatorName\r\n        else\r\n            for colKey in colKeys\r\n                row.push colKey.join(\"-\")\r\n\r\n        result.push row\r\n\r\n        for rowKey in rowKeys\r\n            row = []\r\n            for r in rowKey\r\n                row.push r\r\n\r\n            for colKey in colKeys\r\n                agg = pivotData.getAggregator(rowKey, colKey)\r\n                if agg.value()?\r\n                    row.push agg.value()\r\n                else\r\n                    row.push \"\"\r\n            result.push row\r\n        text = \"\"\r\n        for r in result\r\n            text += r.join(\"\\t\")+\"\\n\"\r\n        \r\n        return $(\"<textarea>\").text(text).css(\r\n                width: ($(window).width() / 2) + \"px\", \r\n                height: ($(window).height() / 2) + \"px\")\r\n    \r\n","(function() {\n  var callWithJQuery;\n\n  callWithJQuery = function(pivotModule) {\n    if (typeof exports === \"object\" && typeof module === \"object\") {\n      return pivotModule(require(\"jquery\"));\n    } else if (typeof define === \"function\" && define.amd) {\n      return define([\"jquery\"], pivotModule);\n    } else {\n      return pivotModule(jQuery);\n    }\n  };\n\n  callWithJQuery(function($) {\n    return $.pivotUtilities.export_renderers = {\n      \"TSV Export\": function(pivotData, opts) {\n        var agg, colAttrs, colKey, colKeys, defaults, i, j, k, l, len, len1, len2, len3, len4, len5, m, n, r, result, row, rowAttr, rowAttrs, rowKey, rowKeys, text;\n        defaults = {\n          localeStrings: {}\n        };\n        opts = $.extend(defaults, opts);\n        rowKeys = pivotData.getRowKeys();\n        if (rowKeys.length === 0) {\n          rowKeys.push([]);\n        }\n        colKeys = pivotData.getColKeys();\n        if (colKeys.length === 0) {\n          colKeys.push([]);\n        }\n        rowAttrs = pivotData.rowAttrs;\n        colAttrs = pivotData.colAttrs;\n        result = [];\n        row = [];\n        for (i = 0, len = rowAttrs.length; i < len; i++) {\n          rowAttr = rowAttrs[i];\n          row.push(rowAttr);\n        }\n        if (colKeys.length === 1 && colKeys[0].length === 0) {\n          row.push(pivotData.aggregatorName);\n        } else {\n          for (j = 0, len1 = colKeys.length; j < len1; j++) {\n            colKey = colKeys[j];\n            row.push(colKey.join(\"-\"));\n          }\n        }\n        result.push(row);\n        for (k = 0, len2 = rowKeys.length; k < len2; k++) {\n          rowKey = rowKeys[k];\n          row = [];\n          for (l = 0, len3 = rowKey.length; l < len3; l++) {\n            r = rowKey[l];\n            row.push(r);\n          }\n          for (m = 0, len4 = colKeys.length; m < len4; m++) {\n            colKey = colKeys[m];\n            agg = pivotData.getAggregator(rowKey, colKey);\n            if (agg.value() != null) {\n              row.push(agg.value());\n            } else {\n              row.push(\"\");\n            }\n          }\n          result.push(row);\n        }\n        text = \"\";\n        for (n = 0, len5 = result.length; n < len5; n++) {\n          r = result[n];\n          text += r.join(\"\\t\") + \"\\n\";\n        }\n        return $(\"<textarea>\").text(text).css({\n          width: ($(window).width() / 2) + \"px\",\n          height: ($(window).height() / 2) + \"px\"\n        });\n      }\n    };\n  });\n\n}).call(this);\n\n//# sourceMappingURL=export_renderers.js.map\n"],"sourceRoot":"/source/"}